{"version":3,"file":"js/428.4c67a81e.js","mappings":"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","sources":["webpack://vuejs_mytick8.com/./src/store/user.js","webpack://vuejs_mytick8.com/./src/components/Breadcrumb.vue","webpack://vuejs_mytick8.com/./src/components/pages/Cover.vue","webpack://vuejs_mytick8.com/./src/components/pages/Cover.vue?0d48","webpack://vuejs_mytick8.com/./src/components/pages/SelectInfo.vue","webpack://vuejs_mytick8.com/./src/components/pages/SelectInfo.vue?8ed4"],"sourcesContent":["import { defineStore } from \"pinia\";\r\n\r\n\r\nexport const useUserStore = defineStore('user', {\r\n    state: () => {\r\n        return {\r\n            user: JSON.parse(localStorage.getItem('user')) || {\r\n                name: '',\r\n                family: '',\r\n                mobile: '',\r\n            },\r\n            token: localStorage.getItem('token') || '',\r\n            q: ''\r\n        }\r\n    },\r\n    getters: {\r\n        getUser(state) {\r\n            return state.user\r\n        },\r\n        getToken(state) {\r\n            return state.token\r\n        },\r\n        getExpiresAt(state) {\r\n            return state.expires_at\r\n        },\r\n        getQ(state) {\r\n            return state.q\r\n        },\r\n        isAuth(state) {\r\n            let token = state.token;\r\n            return token\r\n        },\r\n    },\r\n    actions: {\r\n        setUser(user) {\r\n            this.user = user\r\n            localStorage.setItem('user', JSON.stringify(user));\r\n\r\n        },\r\n        setToken(token) {\r\n            this.token = token\r\n            localStorage.setItem('token', token);\r\n        },\r\n        setExpiresAt(expires_at) {\r\n            this.expires_at = expires_at\r\n            localStorage.setItem('expires_at', expires_at);\r\n        },\r\n        logout() {\r\n            this.user = ''\r\n            this.token = ''\r\n            localStorage.removeItem('user')\r\n            localStorage.removeItem('token')\r\n        },\r\n        setQ(q) {\r\n            this.q = q\r\n        }\r\n    }\r\n})","import script from \"./Breadcrumb.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Breadcrumb.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n    <div class=\"concert-banner\">\r\n        <div class=\"d-grid h-100\" v-if=\"program\">\r\n            <div class=\"concert-banner__caption p-5\">\r\n                <h1 class=\"concert-banner__caption--title pe-2 mb-2\">\r\n                    {{ `${program.artist.name} ${program.artist.family}` }}\r\n                </h1>\r\n                <p class=\"concert-banner__caption--info d-flex justify-content-start align-items-center mb-2\">\r\n                    <img src=\"../../assets/images/ticket-location.svg\" :alt=\"program.hall.hall_name\" class=\"me-1\"\r\n                        width=\"25.1px\" height=\"25.1px\">\r\n                    {{ program.hall.city.city_name }} ،{{ program.hall.hall_name }}\r\n                </p>\r\n                <p class=\"concert-banner__caption--info d-flex justify-content-start align-items-center mb-2\">\r\n                    <img src=\"../../assets/images/ticket-calendar.svg\" :alt=\"program.hall.hall_name\" class=\"me-1\"\r\n                        width=\"25.1px\" height=\"25.1px\">\r\n                    {{ program.run_date }}\r\n                </p>\r\n            </div>\r\n            <div class=\"concert-banner__image\">\r\n                <img class=\"h-100\" :src=\"baseUrl + program.cover\" :alt=\"program.hall.hall_name\">\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport { defineProps } from 'vue';\r\nlet baseUrl = process.env.VUE_APP_BASE_URL;\r\n\r\ndefineProps(['program'])\r\n</script>\r\n","import script from \"./Cover.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Cover.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n    <div v-if=\"loading\" class=\"d-flex justify-content-center mb-5\">\r\n        <div class=\"spinner-border spinner-border-sm text-danger\" role=\"status\">\r\n            <span class=\"visually-hidden\">Loading...</span>\r\n        </div>\r\n    </div>\r\n    <template v-else>\r\n        <Breadcrumb :program=\"program\" />\r\n        <section id=\"select-info\">\r\n            <div class=\"container\">\r\n                <Cover :program=\"program\" />\r\n                <div id=\"buy-process\" class=\"my-5\">\r\n                    <ul class=\"nav justify-content-md-evenly justify-content-center align-items-center\">\r\n                        <li class=\"nav-item buy-process__item col active\">\r\n                            <router-link :to=\"{\r\n                                name: 'select_time',\r\n                                params: {\r\n                                    id: route.params.programId,\r\n                                }\r\n                            }\" class=\"nav-link buy-process__link px-sm-3 px-2\">\r\n                                <div class=\"buy-process--shape\">\r\n                                    <span class=\"buy-process--shape-num\">1</span>\r\n                                </div>\r\n                                <p class=\"buy-process--text\">انتخاب سانس</p>\r\n                            </router-link>\r\n                        </li>\r\n                        <li class=\"nav-item buy-process__item col active\">\r\n                            <router-link :to=\"{\r\n                                name: 'seats',\r\n                                params: {\r\n                                    programId: route.params.programId,\r\n                                    sanId: route.params.sanId\r\n                                }\r\n                            }\" class=\"nav-link buy-process__link px-sm-3 px-2\">\r\n                                <div class=\"buy-process--shape\">\r\n                                    <span class=\"buy-process--shape-num\">2</span>\r\n                                </div>\r\n                                <p class=\"buy-process--text\">انتخاب صندلی</p>\r\n                            </router-link>\r\n                        </li>\r\n                        <li class=\"nav-item buy-process__item col active\">\r\n                            <div class=\"nav-link buy-process__link px-sm-3 px-2\">\r\n                                <div class=\"buy-process--shape\">\r\n                                    <span class=\"buy-process--shape-num\">3</span>\r\n                                </div>\r\n                                <p class=\"buy-process--text\">تکمیل اطلاعات</p>\r\n                            </div>\r\n                        </li>\r\n                        <li class=\"nav-item buy-process__item col\">\r\n                            <a class=\"nav-link buy-process__link px-sm-3 px-2\" href=\"#\">\r\n                                <div class=\"buy-process--shape\">\r\n                                    <span class=\"buy-process--shape-num\">4</span>\r\n                                </div>\r\n                                <p class=\"buy-process--text\">پرداخت</p>\r\n                            </a>\r\n                        </li>\r\n                        <li class=\"nav-item buy-process__item col\">\r\n                            <a class=\"nav-link buy-process__link px-sm-3 px-2\" href=\"#\">\r\n                                <div class=\"buy-process--shape\">\r\n                                    <span class=\"buy-process--shape-num\">5</span>\r\n                                </div>\r\n                                <p class=\"buy-process--text\">دریافت بلیت</p>\r\n                            </a>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div id=\"select-info\" class=\"select-info mb-5\">\r\n                    <form method=\"post\">\r\n                        <div class=\"row\">\r\n                            <div class=\"col-lg-6\">\r\n                                <div class=\"row mb-3\">\r\n                                    <div class=\"col-sm-6\">\r\n                                        <label for=\"InputFirstName\" class=\"form-label form-label--required\">نام</label>\r\n                                        <input type=\"text\" class=\"form-control\" id=\"InputFirstName\" v-model=\"user.name\"\r\n                                            placeholder=\"لطفا نام خود را وارد کنید\">\r\n                                        <span v-if=\"Object.hasOwn(errors, 'name')\" style=\"font-size: 11px;\"\r\n                                            class=\"text-danger\">{{ errors.name.shift() }}</span>\r\n                                    </div>\r\n                                    <div class=\"col-sm-6\">\r\n                                        <label for=\"InputLastName\" class=\"form-label form-label--required\">نام\r\n                                            خانوادگی</label>\r\n                                        <input type=\"text\" class=\"form-control\" v-model=\"user.family\" id=\"InputLastName\"\r\n                                            placeholder=\"لطفا نام خانوادگی خود را وارد کنید\">\r\n                                        <div v-if=\"Object.hasOwn(errors, 'family')\" style=\"font-size: 11px;\"\r\n                                            class=\"text-danger\">{{ errors.family.shift() }}</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row mb-3\">\r\n                                    <div class=\"col-sm-6\">\r\n                                        <label for=\"mobile\" class=\"form-label form-label--required\">موبایل</label>\r\n                                        <input type=\"tel\" class=\"form-control\" id=\"mobile\" v-model=\"user.mobile\"\r\n                                            placeholder=\"09xxxxxxxx مثال\">\r\n                                        <div v-if=\"Object.hasOwn(errors, 'mobile')\" style=\"font-size: 11px;\"\r\n                                            class=\"text-danger\">{{ errors.mobile.shift() }}</div>\r\n                                    </div>\r\n                                    <div class=\"col-sm-6\">\r\n                                        <label for=\"InputBank\" class=\"form-label\">نحوه پرداخت</label>\r\n                                        <select class=\"form-control form-select\" v-model=\"payment_type\" id=\"InputBank\">\r\n                                            <option value=\"gate_bank\">پرداخت آنلاین</option>\r\n                                            <option value=\"wallet\">کیف پول</option>\r\n                                        </select>\r\n                                        <div v-if=\"Object.hasOwn(errors, 'payment_type')\" style=\"font-size: 11px;\"\r\n                                            class=\"text-danger\">{{ errors.payment_type.shift() }}</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row mb-5\" v-if=\"false\">\r\n                                    <div class=\"col-sm-6\">\r\n                                        <label for=\"Inputcaptcha\" class=\"form-label form-label--required\">لطفا متن تصویر\r\n                                            زیر را وارد کنید</label>\r\n                                        <input type=\"text\" class=\"form-control\" v-model=\"captcha\" id=\"Inputcaptcha\"\r\n                                            placeholder=\"لطفا متن تصویر را وارد کنید\">\r\n                                        <div v-if=\"Object.hasOwn(errors, 'captcha')\" style=\"font-size: 11px;\"\r\n                                            class=\"text-danger\">{{ errors.captcha.shift() }}</div>\r\n                                    </div>\r\n                                    <div class=\"captcha col-sm-6 d-flex justify-content-center align-items-end\">\r\n                                        <img :src=\"captchaImg\" alt=\"\" class=\"me-2 img-chaptcha\">\r\n                                        <button class=\"refresh-captcha btn border-0 p-0\" type=\"button\"\r\n                                            @click=\"getCaptcha\">\r\n                                            <div v-if=\"captchaLoading\" class=\"spinner-border spinner-border-sm\"\r\n                                                role=\"status\">\r\n                                                <span class=\"visually-hidden\">Loading...</span>\r\n                                            </div>\r\n                                            <img v-else src=\"../../assets/images/refresh-square.svg\" alt=\"\">\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row mb-5\">\r\n                                    <div class=\"col-sm-6\">\r\n                                        <label for=\"Inputcaptcha\" class=\"form-label\">کد تخفیف دارید؟</label>\r\n                                        <div class=\"d-flex\">\r\n                                            <input type=\"text\" class=\"form-control me-2\" v-model=\"discount\"\r\n                                                id=\"input-discount-code\" placeholder=\"لطفا کد تخفیف را وارد کنید\">\r\n                                            <button class=\"select-chair__select--btn btn mx-auto apply-discount__code\"\r\n                                                @click=\"applyDiscount\" type=\"button\">\r\n                                                <div v-if=\"discountLoading\" class=\"spinner-border spinner-border-sm\"\r\n                                                    role=\"status\">\r\n                                                    <span class=\"visually-hidden\">Loading...</span>\r\n                                                </div>\r\n                                                <span v-else>اعمال</span>\r\n                                            </button>\r\n                                        </div>\r\n                                        <div v-if=\"Object.hasOwn(errors, 'discount')\" style=\"font-size: 11px;\"\r\n                                            class=\"text-danger\">{{ errors.discount.shift() }}</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"select-info__description\">\r\n                                    <h6 class=\"select-info__description--heading mb-3\">قوانین و توضیحات:</h6>\r\n                                    <p class=\"select-info__description--text\">\r\n                                        کلیه کارتهای عضو شتاب قابل قبول است.تمام صندلی های خریداری شده در این خرید، برای\r\n                                        شماره موبایلی که در همین صفحه وارد میکنید صادر شده و اطلاعات برای ایشان پیامک\r\n                                        میشود..پس از این مرحله وارد درگاه پرداخت بانکی میشوید و اشکالات احتمالی در آن\r\n                                        مرحله مربوط به سایت مای تیک ۸ نمیباشد.اگر به هر دلیلی موفق به پرداخت نشوید،\r\n                                        صندلی ها به مدت ۱۰ دقیقه برای شما رزرو میماند(رنگ نارنجی) و پس از آن برای خرید\r\n                                        باز میشوند.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                            <!------------------ select-info__part start ------------------>\r\n                            <div class=\"col-lg-6\">\r\n                                <div class=\"select-info__part mb-3\">\r\n                                    <div\r\n                                        class=\"select-info__title d-flex flex-wrap justify-content-between align-items-center mt-lg-0 mb-1 mt-3\">\r\n                                        <h3 class=\"select-info__title--heading mb-3 px-2\">{{ program.artist &&\r\n                                            program.artist.name }} {{ program.artist && program.artist.family }}</h3>\r\n                                        <ul class=\"select-info__title--list\">\r\n                                            <li\r\n                                                class=\"select-info__title--item d-flex justify-content-start align-items-center mb-2\">\r\n                                                <img src=\"../../assets/images/ticket-location.svg\" alt=\"\" class=\"me-1\"\r\n                                                    width=\"14.9px\" height=\"17.9px\">\r\n                                                {{ program.hall && program.hall.city.city_name }} ،{{ program.hall &&\r\n                                                    program.hall.hall_name }}\r\n                                            </li>\r\n                                            <li\r\n                                                class=\"select-info__title--item d-flex justify-content-start align-items-center mb-2\">\r\n                                                <img src=\"../../assets/images/ticket-calendar.svg\" alt=\"\" class=\"me-1\"\r\n                                                    width=\"18.4px\" height=\"19.9px\">\r\n                                                {{ start_date.d }}\r\n                                            </li>\r\n                                            <li\r\n                                                class=\"select-info__title--item d-flex justify-content-start align-items-center mb-2\">\r\n                                                <img src=\"../../assets/images/ticket-time.svg\" alt=\"\" class=\"me-1\"\r\n                                                    width=\"19px\" height=\"19px\">\r\n                                                {{ start_date.t }}\r\n                                            </li>\r\n                                        </ul>\r\n                                    </div>\r\n\r\n                                    <div class=\"select-info__checkout pb-3\">\r\n                                        <ul\r\n                                            class=\"select-info__checkout--titles nav justify-content-around align-items-center py-2 px-4\">\r\n                                            <li class=\"select-info__checkout--th col text-center\">جایگاه</li>\r\n                                            <li class=\"select-info__checkout--th col text-center\">ردیف</li>\r\n                                            <li class=\"select-info__checkout--th col text-center\">صندلی</li>\r\n                                            <li class=\"select-info__checkout--th col text-center\">قیمت</li>\r\n                                        </ul>\r\n\r\n                                        <ul v-for=\"(cartItem, key) in cartStore.getCart\" :key=\"key\"\r\n                                            class=\"select-info__checkout--list nav justify-content-around align-items-center py-1 px-4\">\r\n                                            <li class=\"select-info__checkout--item col text-center\">{{ cartItem.position\r\n                                                }}</li>\r\n                                            <li class=\"select-info__checkout--item col text-center\">{{ cartItem.row }}\r\n                                            </li>\r\n                                            <li class=\"select-info__checkout--item col text-center\">{{ cartItem.index }}\r\n                                            </li>\r\n                                            <li class=\"select-info__checkout--item col text-center\">{{\r\n                                                cartItem.price.toLocaleString() }} تومان</li>\r\n                                        </ul>\r\n\r\n\r\n                                        <ul\r\n                                            class=\"select-info__checkout--total nav justify-content-evenly align-items-center py-1 px-5\">\r\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"mb-3\" width=\"100%\" height=\"3\"\r\n                                                viewBox=\"0 0 435 3\" fill=\"none\">\r\n                                                <path d=\"M0.205078 1.40454L434.351 2.29138\" stroke=\"#BAC6D3\"></path>\r\n                                            </svg>\r\n                                            <li class=\"select-info__checkout--total-item col text-start\">مبلغ کل:</li>\r\n                                            <li class=\"select-info__checkout--total-item col text-end\">{{\r\n                                                (cartStore.getTotal).toLocaleString() }} تومان </li>\r\n                                        </ul>\r\n                                        <ul\r\n                                            class=\"select-info__checkout--total-tax nav justify-content-evenly align-items-center py-1 px-5\">\r\n                                            <li class=\"select-info__checkout--total-tax-item col text-start\">مبلغ کل با\r\n                                                احتساب ۹٪ ارزش افزوده:</li>\r\n                                            <li class=\"select-info__checkout--total-tax-item col text-end\">{{\r\n                                                (cartStore.getTax + cartStore.getTotal).toLocaleString() }} تومان</li>\r\n                                        </ul>\r\n                                        <ul\r\n                                            class=\"select-info__checkout--total-tax nav justify-content-evenly align-items-center py-1 px-5\">\r\n                                            <li class=\"select-info__checkout--total-tax-item col text-start\">مبلغ قابل\r\n                                                پرداخت:</li>\r\n                                            <li class=\"select-info__checkout--total-tax-item col text-end\">{{\r\n                                                ((cartStore.getTax + cartStore.getTotal) -\r\n                                                    cartStore.getDiscount).toLocaleString() }} تومان</li>\r\n                                        </ul>\r\n\r\n                                    </div>\r\n                                </div>\r\n                                <button type=\"submit\" @click.prevent=\"payment\"\r\n                                    class=\"select-info__part--submit btn d-block w-100 border-0 p-2\">\r\n                                    <div v-if=\"paymentLoading\" class=\"spinner-border spinner-border-sm\" role=\"status\">\r\n                                        <span class=\"visually-hidden\">Loading...</span>\r\n                                    </div>\r\n                                    <span v-else>قوانین را پذیرفته ام، پرداخت</span>\r\n                                </button>\r\n                                <div v-if=\"Object.hasOwn(errors, 'inventory')\" class=\"text-danger\">{{\r\n                                    errors.inventory.shift() }}</div>\r\n                                <div v-if=\"Object.hasOwn(errors, 'error')\" class=\"text-danger\">{{ errors.error.shift()\r\n                                    }}</div>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    </template>\r\n</template>\r\n<script setup>\r\nimport { reactive, ref, onMounted, computed } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport Api from '@/axios/api'\r\nimport { useCartStore } from '../../store/cart'\r\nimport { useToast } from \"vue-toastification\";\r\nimport { useUserStore } from '../../store/user'\r\nimport Cover from './Cover.vue'\r\nimport { useHead } from '@vueuse/head'\r\nimport { checkIsValidTicket, handleError } from '@/utils/helpers';\r\nimport Breadcrumb from '../Breadcrumb.vue';\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst cartStore = useCartStore()\r\nconst userStore = useUserStore()\r\nconst toast = useToast();\r\nconst user = reactive(userStore.getUser)\r\n\r\nlet loading = ref(false)\r\nlet paymentLoading = ref(false)\r\nlet captchaLoading = ref(false)\r\nlet discountLoading = ref(false)\r\nlet program = ref('');\r\nlet captcha = ref('')\r\nlet start_date = ref('')\r\nlet captchaImg = ref('')\r\nlet captchakey = ref('')\r\nlet payment_type = ref('gate_bank')\r\nlet discount = ref('')\r\nlet errors = {}\r\n\r\nonMounted(async () => {\r\n    const apiUrl = `/programs/${route.params.programId}/sans/${route.params.sanId}/select-info`\r\n    try {\r\n        loading.value = true\r\n        const response = await Api.post(apiUrl, {\r\n            seats: cartStore.getCart.map(item => item.id)\r\n        });\r\n\r\n        if (response.data.status == 'success') {\r\n            program.value = response.data.data.program\r\n            start_date.value = response.data.data.start_date\r\n            useHead({\r\n                // Can be static or computed\r\n                title: computed(() => `${program.value.title} - ${program.value.artist.name} ${program.value.artist.family}`),\r\n                meta: [\r\n                    {\r\n                        name: `description`,\r\n                        content: computed(() => {\r\n                            return program.value.title + \" \" + program.value.hall.title + \" \" + program.value.hall.city.title\r\n                        }),\r\n                    },\r\n                ],\r\n\r\n            })\r\n        }\r\n    } catch (err) {\r\n        toast.error(handleError(err).join(''), {\r\n            timeout: 2000\r\n        });\r\n        if (err.response.status == 500) {\r\n            router.push({\r\n                name: 'seats',\r\n                params: {\r\n                    programId: route.params.programId,\r\n                    sanId: route.params.sanId\r\n                }\r\n            })\r\n        }\r\n    } finally {\r\n        loading.value = false\r\n    }\r\n\r\n    //getCaptcha()\r\n})\r\nasync function getCaptcha() {\r\n    try {\r\n        captchaLoading.value = true;\r\n        const res = await Api.get(`reload-captcha`);\r\n        // captchakey.value = res.data.key\r\n        captchaImg.value = res.data.data.captcha\r\n    } catch (err) {\r\n\r\n    } finally {\r\n        captchaLoading.value = false;\r\n    }\r\n}\r\n\r\nasync function payment() {\r\n    paymentLoading.value = true\r\n\r\n    const checkAapiUrl = `/programs/${route.params.programId}/sans/${route.params.sanId}/check/tickets`\r\n    const checkResponse = await checkIsValidTicket(checkAapiUrl);\r\n    if (checkResponse.status == 'error') {\r\n        const backPageUrl = `/programs/${route.params.programId}/sans/${route.params.sanId}/select-chairs`;\r\n        for (let item of checkResponse.expiredAtTickets) {\r\n            cartStore.removeSeatFromCart(item.id);\r\n        }\r\n        router.push(backPageUrl);\r\n    }\r\n\r\n    try {\r\n        let paymentApiUrl = `/programs/${route.params.programId}/sans/${route.params.sanId}/payments?key=${captchakey.value}`;\r\n        const paymentResponse = await Api.post(paymentApiUrl, {\r\n            seats: cartStore.getCart.map(item => item.id),\r\n            name: user.name,\r\n            family: user.family,\r\n            mobile: user.mobile,\r\n            captcha: captcha.value,\r\n            payment_type: payment_type.value,\r\n            platform: 'web',\r\n            discount: discount.value\r\n        });\r\n\r\n        paymentLoading.value = false\r\n        if (paymentResponse.data.status === 'success') {\r\n            //store user and access token to localstorage and state managment\r\n            userStore.setUser(paymentResponse.data.data.user);\r\n            userStore.setToken(paymentResponse.data.data.token);\r\n\r\n            if (payment_type.value == 'wallet') {\r\n                toast.success('خرید با موفقیت انجام شد', {\r\n                    timeout: 2000\r\n                });\r\n                router.push({\r\n                    name: 'Site.show.ticket',\r\n                    params: {\r\n                        program_id: route.params.programId, san_id: route.params.sanId, order_id: paymentResponse.data.data.order_id\r\n                    }\r\n                })\r\n            } else {\r\n                router.push(paymentResponse.data.data.payment_url);\r\n            }\r\n            cartStore.clearCart()\r\n        }\r\n\r\n    } catch (err) {\r\n        console.log(err.response.data.message)\r\n        if (err.response.status == 422) {\r\n            errors = err.response.data.message;\r\n        }\r\n        // {\r\n        //     cartStore.clearCart()\r\n        //     router.push({\r\n        //         name: 'seats',\r\n        //         params: {\r\n        //             programId: route.params.programId,\r\n        //             sanId: route.params.sanId\r\n        //         }\r\n        //     })\r\n        // }\r\n    } finally {\r\n        paymentLoading.value = false\r\n    }\r\n}\r\n\r\nasync function applyDiscount() {\r\n    if (discountLoading.value) {\r\n        return;\r\n    }\r\n    try {\r\n        discountLoading.value = true\r\n        const response = await Api.post(`apply/discount/code`, {\r\n            mobile: user.mobile,\r\n            discount: discount.value,\r\n            total_price: cartStore.getTotal,\r\n        });\r\n\r\n        if (response.data.status == 'success') {\r\n            toast.success('کد تخفیف اعمال گردید', {\r\n                timeout: 2000\r\n            });\r\n            cartStore.setDiscount(parseInt(response.data.amountDiscount))\r\n        }\r\n    } catch (err) {\r\n        if (err.response.status == 422) {\r\n            errors = err.response.data.message;\r\n        }\r\n    } finally {\r\n        discountLoading.value = false\r\n    }\r\n}\r\n</script>","import script from \"./SelectInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SelectInfo.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useUserStore","defineStore","state","user","JSON","parse","localStorage","getItem","name","family","mobile","token","q","getters","getUser","getToken","getExpiresAt","expires_at","getQ","isAuth","actions","setUser","this","setItem","stringify","setToken","setExpiresAt","logout","removeItem","setQ","__exports__","baseUrl","process","route","useRoute","router","useRouter","cartStore","useCartStore","userStore","toast","useToast","reactive","loading","ref","paymentLoading","discountLoading","program","captcha","start_date","captchakey","payment_type","discount","errors","async","payment","value","checkAapiUrl","params","programId","sanId","checkResponse","checkIsValidTicket","status","backPageUrl","item","expiredAtTickets","removeSeatFromCart","id","push","paymentApiUrl","paymentResponse","Api","post","seats","getCart","map","platform","data","success","timeout","program_id","san_id","order_id","payment_url","clearCart","err","console","log","response","message","applyDiscount","total_price","getTotal","setDiscount","parseInt","amountDiscount","onMounted","apiUrl","useHead","title","computed","artist","meta","content","hall","city","error","handleError","join"],"sourceRoot":""}